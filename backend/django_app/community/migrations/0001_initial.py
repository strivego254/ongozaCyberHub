# Generated by Django 5.2.9 on 2025-12-23 12:18

import django.db.models.deletion
import uuid
from django.conf import settings
from django.db import migrations, models


class Migration(migrations.Migration):

    initial = True

    dependencies = [
        migrations.swappable_dependency(settings.AUTH_USER_MODEL),
    ]

    operations = [
        migrations.CreateModel(
            name='Badge',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('name', models.CharField(max_length=100, unique=True)),
                ('slug', models.SlugField(max_length=100, unique=True)),
                ('description', models.TextField()),
                ('icon_url', models.URLField()),
                ('color', models.CharField(default='#4F46E5', max_length=7)),
                ('category', models.CharField(choices=[('circle', 'Circle Achievement'), ('mission', 'Mission Achievement'), ('community', 'Community Contribution'), ('competition', 'Competition'), ('streak', 'Streak'), ('special', 'Special')], max_length=20)),
                ('rarity', models.CharField(choices=[('common', 'Common'), ('uncommon', 'Uncommon'), ('rare', 'Rare'), ('epic', 'Epic'), ('legendary', 'Legendary')], default='common', max_length=20)),
                ('criteria', models.JSONField(default=dict, help_text='Criteria to earn: {type: "mission_count", value: 10}')),
                ('points', models.IntegerField(default=10)),
                ('is_active', models.BooleanField(default=True)),
                ('is_secret', models.BooleanField(default=False)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
            ],
            options={
                'db_table': 'community_badges',
                'ordering': ['category', 'rarity', 'name'],
                'indexes': [models.Index(fields=['category', 'is_active'], name='community_b_categor_f11add_idx'), models.Index(fields=['rarity'], name='community_b_rarity_58e75a_idx')],
            },
        ),
        migrations.CreateModel(
            name='Post',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('post_type', models.CharField(choices=[('text', 'Text Post'), ('media', 'Media Post'), ('event', 'Event'), ('achievement', 'Achievement'), ('poll', 'Poll'), ('announcement', 'Announcement')], default='text', max_length=20)),
                ('title', models.CharField(blank=True, max_length=255, null=True)),
                ('content', models.TextField()),
                ('media_urls', models.JSONField(blank=True, default=list, help_text='List of media URLs: [{"type": "image", "url": "..."}, ...]')),
                ('link_url', models.URLField(blank=True, null=True)),
                ('link_preview', models.JSONField(blank=True, default=dict, help_text='Link preview data: {title, description, image}')),
                ('visibility', models.CharField(choices=[('university', 'University Only'), ('global', 'Global (All Universities)'), ('private', 'Private')], default='university', max_length=20)),
                ('status', models.CharField(choices=[('draft', 'Draft'), ('published', 'Published'), ('hidden', 'Hidden'), ('deleted', 'Deleted')], default='published', max_length=20)),
                ('is_pinned', models.BooleanField(default=False)),
                ('is_featured', models.BooleanField(default=False)),
                ('tags', models.JSONField(blank=True, default=list, help_text='Hashtags: ["hackathon", "security"]')),
                ('mentions', models.JSONField(blank=True, default=list, help_text='Mentioned user IDs')),
                ('event_details', models.JSONField(blank=True, default=dict, help_text='Event details: {\n            "start_time": "2025-01-15T09:00:00Z",\n            "end_time": "2025-01-15T17:00:00Z",\n            "location": "Virtual / Room 101",\n            "modality": "online|onsite|hybrid",\n            "registration_url": "https://...",\n            "max_participants": 100,\n            "rsvp_count": 0,\n            "is_competition": true,\n            "competition_type": "ctf|hackathon|quiz|webinar",\n            "prizes": ["1st: $500", "2nd: $250"]\n        }')),
                ('achievement_type', models.CharField(blank=True, help_text='Type: circle_milestone, mission_complete, badge, certification, portfolio_item', max_length=50, null=True)),
                ('achievement_data', models.JSONField(blank=True, default=dict, help_text='Achievement details: {\n            "type": "mission|circle|badge|certification",\n            "circle_level": 3,\n            "phase": 2,\n            "score": 950,\n            "badge_name": "DFIR Champion",\n            "mission_id": "uuid",\n            "portfolio_item_id": "uuid",\n            "icon_url": "...",\n            "color": "#ff6b35"\n        }')),
                ('poll_options', models.JSONField(blank=True, default=list, help_text='Poll options: [\n            {"id": "uuid", "label": "Option A", "votes": 0},\n            {"id": "uuid", "label": "Option B", "votes": 0}\n        ]')),
                ('poll_ends_at', models.DateTimeField(blank=True, null=True)),
                ('poll_multiple_choice', models.BooleanField(default=False)),
                ('poll_total_votes', models.IntegerField(default=0)),
                ('pinned_at', models.DateTimeField(blank=True, null=True)),
                ('pin_expires_at', models.DateTimeField(blank=True, null=True)),
                ('reaction_count', models.IntegerField(default=0)),
                ('comment_count', models.IntegerField(default=0)),
                ('share_count', models.IntegerField(default=0)),
                ('view_count', models.IntegerField(default=0)),
                ('trending_score', models.DecimalField(decimal_places=2, default=0, help_text='Computed score for trending algorithm', max_digits=10)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('published_at', models.DateTimeField(blank=True, null=True)),
                ('author', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='community_posts', to=settings.AUTH_USER_MODEL)),
                ('pinned_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='pinned_posts', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'db_table': 'community_posts',
                'ordering': ['-created_at'],
            },
        ),
        migrations.CreateModel(
            name='Comment',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('content', models.TextField()),
                ('mentions', models.JSONField(blank=True, default=list)),
                ('is_edited', models.BooleanField(default=False)),
                ('is_deleted', models.BooleanField(default=False)),
                ('reaction_count', models.IntegerField(default=0)),
                ('reply_count', models.IntegerField(default=0)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('author', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='community_comments', to=settings.AUTH_USER_MODEL)),
                ('parent', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, related_name='replies', to='community.comment')),
                ('post', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='comments', to='community.post')),
            ],
            options={
                'db_table': 'community_comments',
                'ordering': ['created_at'],
            },
        ),
        migrations.CreateModel(
            name='Reaction',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('reaction_type', models.CharField(choices=[('like', 'üëç'), ('love', '‚ù§Ô∏è'), ('celebrate', 'üéâ'), ('insightful', 'üí°'), ('curious', 'ü§î'), ('fire', 'üî•'), ('clap', 'üëè')], max_length=20)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('comment', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, related_name='reactions', to='community.comment')),
                ('post', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, related_name='reactions', to='community.post')),
                ('user', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='community_reactions', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'db_table': 'community_reactions',
            },
        ),
        migrations.CreateModel(
            name='University',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('name', models.CharField(max_length=255, unique=True)),
                ('slug', models.SlugField(max_length=100, unique=True)),
                ('code', models.CharField(db_index=True, help_text='Short code for matching, e.g., UON, KU, JKUAT', max_length=20, unique=True)),
                ('short_name', models.CharField(blank=True, max_length=50, null=True)),
                ('email_domains', models.JSONField(default=list, help_text='List of email domains for auto-mapping, e.g., ["stanford.edu", "alumni.stanford.edu"]')),
                ('logo_url', models.URLField(blank=True, null=True)),
                ('banner_url', models.URLField(blank=True, null=True)),
                ('description', models.TextField(blank=True, null=True)),
                ('website', models.URLField(blank=True, null=True)),
                ('country', models.CharField(blank=True, max_length=2, null=True)),
                ('city', models.CharField(blank=True, max_length=100, null=True)),
                ('region', models.CharField(blank=True, max_length=100, null=True)),
                ('location', models.TextField(blank=True, help_text='Full address or location description', null=True)),
                ('timezone', models.CharField(default='Africa/Nairobi', max_length=50)),
                ('is_verified', models.BooleanField(default=False)),
                ('is_active', models.BooleanField(default=True)),
                ('allow_cross_university_posts', models.BooleanField(default=True)),
                ('member_count', models.IntegerField(default=0)),
                ('post_count', models.IntegerField(default=0)),
                ('active_student_count', models.IntegerField(default=0)),
                ('events_count', models.IntegerField(default=0)),
                ('competitions_participated', models.IntegerField(default=0)),
                ('engagement_score', models.DecimalField(decimal_places=2, default=0, help_text='Computed engagement score for university ranking', max_digits=10)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
            ],
            options={
                'verbose_name_plural': 'Universities',
                'db_table': 'community_universities',
                'ordering': ['name'],
                'indexes': [models.Index(fields=['slug'], name='community_u_slug_207bab_idx'), models.Index(fields=['code'], name='community_u_code_73525e_idx'), models.Index(fields=['is_active', 'is_verified'], name='community_u_is_acti_e7e546_idx'), models.Index(fields=['engagement_score'], name='community_u_engagem_87d958_idx')],
            },
        ),
        migrations.AddField(
            model_name='post',
            name='university',
            field=models.ForeignKey(blank=True, help_text='University this post belongs to (null for global posts)', null=True, on_delete=django.db.models.deletion.CASCADE, related_name='posts', to='community.university'),
        ),
        migrations.CreateModel(
            name='ModerationLog',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('action', models.CharField(choices=[('hide_post', 'Hide Post'), ('delete_post', 'Delete Post'), ('hide_comment', 'Hide Comment'), ('delete_comment', 'Delete Comment'), ('warn_user', 'Warn User'), ('suspend_user', 'Suspend User'), ('pin_post', 'Pin Post'), ('unpin_post', 'Unpin Post'), ('feature_post', 'Feature Post'), ('unfeature_post', 'Unfeature Post')], max_length=30)),
                ('reason', models.TextField()),
                ('notes', models.TextField(blank=True, null=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('moderator', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='moderation_actions', to=settings.AUTH_USER_MODEL)),
                ('target_comment', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='moderation_logs', to='community.comment')),
                ('target_user', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='received_moderation_actions', to=settings.AUTH_USER_MODEL)),
                ('target_post', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='moderation_logs', to='community.post')),
                ('university', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='moderation_logs', to='community.university')),
            ],
            options={
                'db_table': 'community_moderation_logs',
                'ordering': ['-created_at'],
            },
        ),
        migrations.CreateModel(
            name='Leaderboard',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('leaderboard_type', models.CharField(choices=[('overall', 'Overall XP'), ('missions', 'Missions Completed'), ('community', 'Community Engagement'), ('competitions', 'Competition Wins'), ('university', 'University Ranking'), ('weekly', 'Weekly Top Performers'), ('monthly', 'Monthly Top Performers')], max_length=20)),
                ('scope', models.CharField(choices=[('global', 'Global'), ('university', 'University'), ('track', 'Track')], default='global', max_length=20)),
                ('track_key', models.CharField(blank=True, max_length=100, null=True)),
                ('period_start', models.DateField()),
                ('period_end', models.DateField()),
                ('rankings', models.JSONField(default=list, help_text='[{"rank": 1, "user_id": "...", "score": 1500, "change": 2}, ...]')),
                ('university_rankings', models.JSONField(default=list, help_text='[{"rank": 1, "university_id": "...", "score": 15000, "member_count": 500}, ...]')),
                ('is_current', models.BooleanField(default=True)),
                ('generated_at', models.DateTimeField(auto_now_add=True)),
                ('university', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, related_name='leaderboards', to='community.university')),
            ],
            options={
                'db_table': 'community_leaderboards',
                'ordering': ['-period_end', 'leaderboard_type'],
            },
        ),
        migrations.CreateModel(
            name='Follow',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('follow_type', models.CharField(choices=[('user', 'User'), ('university', 'University'), ('tag', 'Topic/Tag')], max_length=20)),
                ('followed_tag', models.CharField(blank=True, max_length=100, null=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('followed_user', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, related_name='followers', to=settings.AUTH_USER_MODEL)),
                ('follower', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='following', to=settings.AUTH_USER_MODEL)),
                ('followed_university', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, related_name='followers', to='community.university')),
            ],
            options={
                'db_table': 'community_follows',
            },
        ),
        migrations.CreateModel(
            name='CommunityEvent',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('title', models.CharField(max_length=255)),
                ('slug', models.SlugField(max_length=100, unique=True)),
                ('description', models.TextField()),
                ('event_type', models.CharField(choices=[('competition', 'Competition'), ('hackathon', 'Hackathon'), ('webinar', 'Webinar'), ('workshop', 'Workshop'), ('meetup', 'Meetup'), ('ctf', 'CTF Challenge'), ('other', 'Other')], max_length=20)),
                ('banner_url', models.URLField(blank=True, null=True)),
                ('thumbnail_url', models.URLField(blank=True, null=True)),
                ('starts_at', models.DateTimeField()),
                ('ends_at', models.DateTimeField()),
                ('registration_deadline', models.DateTimeField(blank=True, null=True)),
                ('timezone', models.CharField(default='UTC', max_length=50)),
                ('is_virtual', models.BooleanField(default=True)),
                ('location', models.CharField(blank=True, max_length=255, null=True)),
                ('meeting_url', models.URLField(blank=True, null=True)),
                ('visibility', models.CharField(choices=[('university', 'University Only'), ('global', 'Global (All Universities)'), ('invite_only', 'Invite Only')], default='global', max_length=20)),
                ('status', models.CharField(choices=[('draft', 'Draft'), ('upcoming', 'Upcoming'), ('ongoing', 'Ongoing'), ('completed', 'Completed'), ('cancelled', 'Cancelled')], default='upcoming', max_length=20)),
                ('max_participants', models.IntegerField(blank=True, null=True)),
                ('prizes', models.JSONField(blank=True, default=list, help_text='[{"place": 1, "reward": "Certificate + Badge", "value": "$500"}, ...]')),
                ('badges_awarded', models.JSONField(blank=True, default=list, help_text='Badges to award: ["hackathon_participant", "ctf_winner"]')),
                ('participant_count', models.IntegerField(default=0)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('created_by', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='created_events', to=settings.AUTH_USER_MODEL)),
                ('related_post', models.OneToOneField(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='event', to='community.post')),
                ('university', models.ForeignKey(blank=True, help_text='Host university (null for global events)', null=True, on_delete=django.db.models.deletion.CASCADE, related_name='events', to='community.university')),
            ],
            options={
                'db_table': 'community_events',
                'ordering': ['starts_at'],
            },
        ),
        migrations.CreateModel(
            name='UniversityDomain',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('domain', models.CharField(db_index=True, help_text='Email domain, e.g., uonbi.ac.ke, students.ku.ac.ke', max_length=100, unique=True)),
                ('domain_type', models.CharField(choices=[('primary', 'Primary Domain'), ('student', 'Student Email'), ('alumni', 'Alumni Email'), ('staff', 'Staff Email'), ('other', 'Other')], default='primary', max_length=20)),
                ('is_active', models.BooleanField(default=True)),
                ('auto_verify', models.BooleanField(default=False, help_text='Automatically verify users registering with this domain')),
                ('default_role', models.CharField(default='student', help_text='Default role for users with this domain', max_length=20)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('university', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='domains', to='community.university')),
            ],
            options={
                'verbose_name_plural': 'University Domains',
                'db_table': 'community_university_domains',
                'ordering': ['university', 'domain'],
            },
        ),
        migrations.CreateModel(
            name='UniversityMembership',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('role', models.CharField(choices=[('student', 'Student'), ('faculty', 'Faculty'), ('staff', 'Staff'), ('alumni', 'Alumni'), ('admin', 'University Admin')], default='student', max_length=20)),
                ('status', models.CharField(choices=[('pending', 'Pending Verification'), ('active', 'Active'), ('suspended', 'Suspended'), ('graduated', 'Graduated')], default='active', max_length=20)),
                ('mapped_method', models.CharField(choices=[('email_domain', 'Email Domain'), ('manual', 'Manual Selection'), ('admin', 'Admin Assignment'), ('import', 'Bulk Import')], default='manual', help_text='How was this mapping created?', max_length=20)),
                ('is_primary', models.BooleanField(default=True)),
                ('auto_mapped', models.BooleanField(default=False)),
                ('verified_at', models.DateTimeField(blank=True, null=True)),
                ('mapped_at', models.DateTimeField(auto_now_add=True)),
                ('student_id', models.CharField(blank=True, max_length=50, null=True)),
                ('department', models.CharField(blank=True, max_length=100, null=True)),
                ('faculty', models.CharField(blank=True, max_length=100, null=True)),
                ('program', models.CharField(blank=True, max_length=150, null=True)),
                ('graduation_year', models.IntegerField(blank=True, null=True)),
                ('year_of_study', models.IntegerField(blank=True, null=True)),
                ('joined_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('university', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='memberships', to='community.university')),
                ('user', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='university_memberships', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'db_table': 'community_university_memberships',
            },
        ),
        migrations.CreateModel(
            name='UserBadge',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('earned_at', models.DateTimeField(auto_now_add=True)),
                ('earned_via', models.CharField(blank=True, help_text='mission, event, community_action, etc.', max_length=50, null=True)),
                ('reference_id', models.UUIDField(blank=True, help_text='ID of mission/event that awarded this badge', null=True)),
                ('is_featured', models.BooleanField(default=False)),
                ('badge', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='earners', to='community.badge')),
                ('user', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='earned_badges', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'db_table': 'community_user_badges',
            },
        ),
        migrations.CreateModel(
            name='UserCommunityStats',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('total_posts', models.IntegerField(default=0)),
                ('total_comments', models.IntegerField(default=0)),
                ('total_reactions_given', models.IntegerField(default=0)),
                ('total_reactions_received', models.IntegerField(default=0)),
                ('total_badges', models.IntegerField(default=0)),
                ('total_points', models.IntegerField(default=0)),
                ('current_streak_days', models.IntegerField(default=0)),
                ('longest_streak_days', models.IntegerField(default=0)),
                ('events_attended', models.IntegerField(default=0)),
                ('competitions_won', models.IntegerField(default=0)),
                ('global_rank', models.IntegerField(blank=True, null=True)),
                ('university_rank', models.IntegerField(blank=True, null=True)),
                ('last_post_at', models.DateTimeField(blank=True, null=True)),
                ('last_activity_at', models.DateTimeField(blank=True, null=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('user', models.OneToOneField(on_delete=django.db.models.deletion.CASCADE, related_name='community_stats', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'db_table': 'community_user_stats',
            },
        ),
        migrations.CreateModel(
            name='EventParticipant',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('status', models.CharField(choices=[('registered', 'Registered'), ('confirmed', 'Confirmed'), ('attended', 'Attended'), ('no_show', 'No Show'), ('cancelled', 'Cancelled')], default='registered', max_length=20)),
                ('team_name', models.CharField(blank=True, max_length=100, null=True)),
                ('team_role', models.CharField(blank=True, max_length=50, null=True)),
                ('placement', models.IntegerField(blank=True, null=True)),
                ('score', models.DecimalField(blank=True, decimal_places=2, max_digits=10, null=True)),
                ('registered_at', models.DateTimeField(auto_now_add=True)),
                ('checked_in_at', models.DateTimeField(blank=True, null=True)),
                ('event', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='participants', to='community.communityevent')),
                ('user', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='event_participations', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'db_table': 'community_event_participants',
                'indexes': [models.Index(fields=['event', 'status'], name='community_e_event_i_e74dc0_idx'), models.Index(fields=['user', 'status'], name='community_e_user_id_70fdee_idx')],
                'unique_together': {('event', 'user')},
            },
        ),
        migrations.CreateModel(
            name='PollVote',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('option_id', models.IntegerField()),
                ('voted_at', models.DateTimeField(auto_now_add=True)),
                ('user', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='poll_votes', to=settings.AUTH_USER_MODEL)),
                ('post', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='poll_votes', to='community.post')),
            ],
            options={
                'db_table': 'community_poll_votes',
                'indexes': [models.Index(fields=['post', 'option_id'], name='community_p_post_id_7448db_idx')],
                'unique_together': {('post', 'user', 'option_id')},
            },
        ),
        migrations.AddIndex(
            model_name='comment',
            index=models.Index(fields=['post', 'created_at'], name='community_c_post_id_2fbac0_idx'),
        ),
        migrations.AddIndex(
            model_name='comment',
            index=models.Index(fields=['author', '-created_at'], name='community_c_author__5294bb_idx'),
        ),
        migrations.AddIndex(
            model_name='comment',
            index=models.Index(fields=['parent'], name='community_c_parent__a1f1ce_idx'),
        ),
        migrations.AddIndex(
            model_name='reaction',
            index=models.Index(fields=['post', 'reaction_type'], name='community_r_post_id_ea8323_idx'),
        ),
        migrations.AddIndex(
            model_name='reaction',
            index=models.Index(fields=['comment', 'reaction_type'], name='community_r_comment_461f79_idx'),
        ),
        migrations.AddIndex(
            model_name='reaction',
            index=models.Index(fields=['user', 'post'], name='community_r_user_id_bd18bc_idx'),
        ),
        migrations.AddIndex(
            model_name='reaction',
            index=models.Index(fields=['user', 'comment'], name='community_r_user_id_f5da0c_idx'),
        ),
        migrations.AddConstraint(
            model_name='reaction',
            constraint=models.UniqueConstraint(condition=models.Q(('post__isnull', False)), fields=('user', 'post', 'reaction_type'), name='unique_post_reaction'),
        ),
        migrations.AddConstraint(
            model_name='reaction',
            constraint=models.UniqueConstraint(condition=models.Q(('comment__isnull', False)), fields=('user', 'comment', 'reaction_type'), name='unique_comment_reaction'),
        ),
        migrations.AddIndex(
            model_name='post',
            index=models.Index(fields=['university', 'status', '-created_at'], name='community_p_univers_592dd0_idx'),
        ),
        migrations.AddIndex(
            model_name='post',
            index=models.Index(fields=['author', '-created_at'], name='community_p_author__439191_idx'),
        ),
        migrations.AddIndex(
            model_name='post',
            index=models.Index(fields=['post_type', 'status'], name='community_p_post_ty_da4788_idx'),
        ),
        migrations.AddIndex(
            model_name='post',
            index=models.Index(fields=['visibility', 'status', '-created_at'], name='community_p_visibil_96e364_idx'),
        ),
        migrations.AddIndex(
            model_name='post',
            index=models.Index(fields=['is_pinned', '-created_at'], name='community_p_is_pinn_7c7f64_idx'),
        ),
        migrations.AddIndex(
            model_name='post',
            index=models.Index(fields=['is_featured', '-created_at'], name='community_p_is_feat_c9e79a_idx'),
        ),
        migrations.AddIndex(
            model_name='moderationlog',
            index=models.Index(fields=['moderator', '-created_at'], name='community_m_moderat_2774bf_idx'),
        ),
        migrations.AddIndex(
            model_name='moderationlog',
            index=models.Index(fields=['action', '-created_at'], name='community_m_action_fdeca6_idx'),
        ),
        migrations.AddIndex(
            model_name='moderationlog',
            index=models.Index(fields=['university', '-created_at'], name='community_m_univers_5ff2b7_idx'),
        ),
        migrations.AddIndex(
            model_name='leaderboard',
            index=models.Index(fields=['leaderboard_type', 'scope', 'is_current'], name='community_l_leaderb_6db7d8_idx'),
        ),
        migrations.AddIndex(
            model_name='leaderboard',
            index=models.Index(fields=['university', 'leaderboard_type'], name='community_l_univers_6733af_idx'),
        ),
        migrations.AddIndex(
            model_name='leaderboard',
            index=models.Index(fields=['period_start', 'period_end'], name='community_l_period__5f0830_idx'),
        ),
        migrations.AddIndex(
            model_name='follow',
            index=models.Index(fields=['follower', 'follow_type'], name='community_f_followe_2b1456_idx'),
        ),
        migrations.AddIndex(
            model_name='follow',
            index=models.Index(fields=['followed_user'], name='community_f_followe_231652_idx'),
        ),
        migrations.AddIndex(
            model_name='follow',
            index=models.Index(fields=['followed_university'], name='community_f_followe_f497c0_idx'),
        ),
        migrations.AddIndex(
            model_name='follow',
            index=models.Index(fields=['followed_tag'], name='community_f_followe_63fd29_idx'),
        ),
        migrations.AddIndex(
            model_name='communityevent',
            index=models.Index(fields=['status', 'starts_at'], name='community_e_status_fcee70_idx'),
        ),
        migrations.AddIndex(
            model_name='communityevent',
            index=models.Index(fields=['university', 'status'], name='community_e_univers_00482d_idx'),
        ),
        migrations.AddIndex(
            model_name='communityevent',
            index=models.Index(fields=['event_type', 'status'], name='community_e_event_t_7d36af_idx'),
        ),
        migrations.AddIndex(
            model_name='communityevent',
            index=models.Index(fields=['visibility', 'status'], name='community_e_visibil_8f0af7_idx'),
        ),
        migrations.AddIndex(
            model_name='universitydomain',
            index=models.Index(fields=['domain'], name='community_u_domain_586f37_idx'),
        ),
        migrations.AddIndex(
            model_name='universitydomain',
            index=models.Index(fields=['is_active'], name='community_u_is_acti_6f307e_idx'),
        ),
        migrations.AddIndex(
            model_name='universitymembership',
            index=models.Index(fields=['user', 'is_primary'], name='community_u_user_id_762fed_idx'),
        ),
        migrations.AddIndex(
            model_name='universitymembership',
            index=models.Index(fields=['university', 'status'], name='community_u_univers_cb68c5_idx'),
        ),
        migrations.AddIndex(
            model_name='universitymembership',
            index=models.Index(fields=['role'], name='community_u_role_cb33c3_idx'),
        ),
        migrations.AddIndex(
            model_name='universitymembership',
            index=models.Index(fields=['mapped_method'], name='community_u_mapped__effc62_idx'),
        ),
        migrations.AlterUniqueTogether(
            name='universitymembership',
            unique_together={('user', 'university')},
        ),
        migrations.AddIndex(
            model_name='userbadge',
            index=models.Index(fields=['user', 'is_featured'], name='community_u_user_id_0ba414_idx'),
        ),
        migrations.AddIndex(
            model_name='userbadge',
            index=models.Index(fields=['badge', 'earned_at'], name='community_u_badge_i_27dcb2_idx'),
        ),
        migrations.AlterUniqueTogether(
            name='userbadge',
            unique_together={('user', 'badge')},
        ),
        migrations.AddIndex(
            model_name='usercommunitystats',
            index=models.Index(fields=['total_points'], name='community_u_total_p_00db78_idx'),
        ),
        migrations.AddIndex(
            model_name='usercommunitystats',
            index=models.Index(fields=['global_rank'], name='community_u_global__9e7192_idx'),
        ),
    ]
